/*  lanyrd.js - v0.0.1 
 *  Copyright 2011-2012, Dharmafly <http://dharmafly.com> 
 *  Released under the MIT License 
 *  More Information: https://github.com/dharmafly/lanyrd.js 
 */(function(a,b,c,d){function i(a){a=f.isArray(a)?a:[a];for(var b=0,c=a.length,d;b<c;b+=1){d=a[b];if(d instanceof i||d instanceof j)d=d.get();this[b]=d}this.length=a.length}function j(a){a=a||{},this.url=a.url,this.data=a.data||{};var b=a.deferred||f.deferred();this.url&&(this.fetch=function(a,c){if(this.state()!==j.PENDING)return this;var d=this.url,g,h;return e.requestType===f.request.JSONP&&(d+=(d.indexOf("?")<0?"?":"&")+"callback=?"),g=f.request(d),h=this,g.done(function(){h.data=g.data,b.resolveWith(h,[h,g])}),g.fail(function(){b.rejectWith(h,[h,g])}),this.then(a,c)}),b.promise(this)}"use strict";var e,f,g,h;f={a:c.document&&c.document.createElement("a"),isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},each:function(a,b,c){var d=0,e=a.length,f;if(typeof e=="number")for(;d<e;d+=1)f=a[d],b.call(c||f,f,d,a);else for(d in a)a.hasOwnProperty(d)&&(f=a[d],b.call(c||f,f,d,a));return a},keys:function(a){return f.map(a,function(a,b){return b})},map:function(a,b,c){var d=[];return f.each(a,function(a){d.push(b?b.apply(this,arguments):a)},c),d},filter:function(a,b,c){var d=[];return f.each(a,function(a){b.apply(this,arguments)&&d.push(a)},c),d},extend:function(a){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=c.length,e=0,f,g;for(;e<d;e+=1){f=c[e];for(g in f)f.hasOwnProperty(g)&&(b[g]=f[g])}return b},invoke:function(a,b){var c=[],d=[].slice.call(arguments,2);return f.each(a,function(a){c.push(a[b].apply(a,d))}),c},pluck:function(a,b,c){var d=[].slice.call(arguments,2);return f.map(a,function(a){return f.keypath(a,b,c)})},deferred:function(){return b&&b.Deferred?new b.Deferred:new f._.Deferred},when:function(a){var c=arguments.length===1&&f.isArray(a)?a:arguments;return b&&b.Deferred?b.when.apply(b,c):f._.when.apply(f._,c)},request:function(a){var b=e.requestType,c=f.rawRequest(a,b),d=f.deferred(),g=d.promise({data:null,type:b,xhr:b===f.request.JSONP?null:c});return c.then(function(a){g.data=a,d[!a||a.error?"reject":"resolve"](g)},function(){d.reject(g)}),g},rawRequest:function(a,c){return c=c||"json",b?b.ajax({url:a,dataType:c}):g.utils[c](a)},escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},keypath:function(b,c,e,f){var g=(c||"").split("."),h;if(!c)return b;while(b&&g.length){h=g.shift();if(!(b.hasOwnProperty(h)||f===!0&&b[h]!==d))break;b=b[h];if(g.length===0&&b!==d)return b}return arguments.length>2?e:null},pathname:function(a){return f.a.href=a||"/",f.a.pathname}},f.request.JSON="json",f.request.JSONP="jsonp",i.prototype={constructor:i,get:function(a,b){return f.keypath(this[0],a,b)},escape:function(a,b){return f.escape(this.get(a,b))},related:function(a){var b=a.split("."),c=b.pop(),d;return b.push("api_urls"),d=this.get(b.join("."),{})[c],d||(d=this.get(a)),d?new j({url:d}):j.noop()},fetchRelated:function(a,b,c){return this.related(a).fetch(b,c)},fetchAllRelated:function(a,c,d){function g(b){return b.fetchRelated(a)}var e=f.deferred();return b.when.apply(b,this.map(g)).then(function(){var a=[],c=[];b.each(arguments,function(){c.push(this[1]),a.push(this[0])}),e.resolve(a,c)},e.reject),e.promise().then(c,d)},at:function(a){return a=a<0?a+this.length:a,this[a]||null}},f.each(["each","map","filter","pluck","invoke"],function(a){i.prototype[a]=function(){return f[a].apply(this,[].concat.apply(this,arguments))}}),j.PREV="prev",j.NEXT="next",j.RESOLVED="resolved",j.REJECTED="rejected",j.PENDING="pending",j.noop=function(a){var b=f.deferred(),c=new j(f.extend({deferred:b},a));return b.rejectWith(c,[c,null]),c},j.prototype={constructor:j,url:null,data:null,fetch:function(){return this},fetched:function(){return this.state&&this.state()===j.RESOLVED},related:function(a){return this.collection().related(a)},get:function(a,b){return f.keypath(this.data,a,b)},escape:function(a,b){return f.escape(this.get(a,b))},collection:function(a){var b=this.get(a);return b&&(b=new i(b)),b},paginate:function(a){var b=this.get("pagination.api_urls",{})[a];return b?new j({url:b}):j.noop()},paginated:function(){return this.get("pagination.num_pages",1)>1},first:function(){return this.get("pagination.page",1)===1},last:function(){var a=this.get("pagination",{});return a.page===a.num_pages},next:function(a,b){return this.paginate(j.NEXT).fetch().then(a,b)},prev:function(a,b){return this.paginate(j.PREV).fetch().then(a,b)},all:function(a,b){function g(){function g(c,g){f-=1;if(f)return;g?d.rejectWith(e,[e,g]):(e.data={},e.data[a]=b,d.resolveWith(e,[e]))}var a=c.get("pagination.paginated_key"),b=[],f=2;(function h(c){return c.flag||(c.flag=!0,d.notifyWith(c,arguments),b=c.get(a).slice().concat(b)),c.prev().then(h,g)})(c),function i(c){return c.flag||(c.flag=!0,d.notifyWith(c,arguments),b=b.concat(c.get(a))),c.next().then(i,g)}(c)}var c=this,d=f.deferred(),e=new j({deferred:d});return this.fetched()?g():this.fetch().always(g),e.then(a,b)}},g={API_DOMAIN:"http://lanyrd.asyncjs.com",conference:function(a){return this.resource({url:this.url(a)})},person:function(a){var b=this.url(a).replace(/\/profile\//i,"/people/");return this.resource({url:b})},place:function(a){return this.resource({url:this.url(a)})},topic:function(a){return this.resource({url:this.url(a)})},collection:function(a){return new i(a)},resource:function(a){return new j(a)},url:function(a){return this.API_DOMAIN+f.pathname(a)},config:function(a){f.extend(e,a)},utils:f,noConflict:function(){return c.lanyrd=a,g},Collection:i,Resource:j},e={requestType:f.request.JSONP},typeof c.define=="function"&&c.define.amd?c.define("lanyrd",function(){return g}):c.exports?(require("./lanyrd/deferred")(f),require("./lanyrd/request")(f),h=require("url").parse,g.utils.pathname=function(a){return h(a).pathname},e.requestType=f.request.JSON,c.exports=g):c.lanyrd=g})(this.lanyrd,this.jQuery,typeof module!="undefined"?module:this),function(){(function(a){function q(a){var b=p[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var b={},c=Array.prototype,d=Object.prototype,e=d.hasOwnProperty,f=d.toString,g=c.forEach,h=c.slice,i=function(a,c,d){var f,h,i;if(!a)return;if(g&&a.forEach===g)a.forEach(c,d);else if(a.length===+a.length){for(h=0,i=a.length;h<i;h++)if(h in a&&c.call(d,a[h],h,a)===b)return}else for(f in a)if(e.call(a,f)&&c.call(d,a[f],f,a)===b)return},j=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},k=function(a){return i(h.call(arguments,1),function(b){var c;for(c in b)b[c]!==void 0&&(a[c]=b[c])}),a},l={"[object Array]":"array","[object Function]":"function"},m=function(a){return a?l[f.call(a)]||"object":String(a)},n="done fail isResolved isRejected promise then always pipe".split(" "),o={},p={};o.Callbacks=function(a){a=a?p[a]||q(a):{};var b=[],c=[],d,e,f,g,h,i=function(c){var d,e,f,g,h;for(d=0,e=c.length;d<e;d++)f=c[d],g=m(f),g==="array"?i(f):g==="function"&&(!a.unique||!k.has(f))&&b.push(f)},j=function(i,j){j=j||[],d=!a.memory||[i,j],e=!0,h=f||0,f=0,g=b.length;for(;b&&h<g;h++)if(b[h].apply(i,j)===!1&&a.stopOnFalse){d=!0;break}e=!1,b&&(a.once?d===!0?k.disable():b=[]:c&&c.length&&(d=c.shift(),k.fireWith(d[0],d[1])))},k={add:function(){if(b){var a=b.length;i(arguments),e?g=b.length:d&&d!==!0&&(f=a,j(d[0],d[1]))}return this},remove:function(){if(b){var c=arguments,d=0,f=c.length;for(;d<f;d++)for(var i=0;i<b.length;i++)if(c[d]===b[i]){e&&i<=g&&(g--,i<=h&&h--),b.splice(i--,1);if(a.unique)break}}return this},has:function(a){if(b){var c=0,d=b.length;for(;c<d;c++)if(a===b[c])return!0}return!1},empty:function(){return b=[],this},disable:function(){return b=c=d=undefined,this},disabled:function(){return!b},lock:function(){return c=undefined,(!d||d===!0)&&k.disable(),this},locked:function(){return!c},fireWith:function(b,f){return c&&(e?a.once||c.push([b,f]):(!a.once||!d)&&j(b,f)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},o.Deferred=function(a){var b=o.Callbacks("once memory"),c=o.Callbacks("once memory"),d=o.Callbacks("memory"),e="pending",f={resolve:b,reject:c,notify:d},g={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){return h.done(a).fail(b).progress(c),this},always:function(){return h.done.apply(h,arguments).fail.apply(h,arguments),this},pipe:function(a,b,c){return o.Deferred(function(d){i({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=a[0],e=a[1],f;j(c)?h[b](function(){f=c.apply(this,arguments),f&&j(f.promise)?f.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===h?d:this,[f])}):h[b](d[e])})}).promise()},promise:function(a){if(!a)a=g;else for(var b in g)a[b]=g[b];return a}},h=g.promise({}),k;for(k in f)h[k]=f[k].fire,h[k+"With"]=f[k].fireWith;return h.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(h,h),h},o.when=function(a){function l(a){return function(c){b[a]=arguments.length>1?h.call(arguments,0):c,--f||i.resolveWith(i,b)}}function m(a){return function(b){e[a]=arguments.length>1?h.call(arguments,0):b,i.notifyWith(k,e)}}var b=h.call(arguments,0),c=0,d=b.length,e=new Array(d),f=d,g=d,i=d<=1&&a&&j(a.promise)?a:o.Deferred(),k=i.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&j(b[c].promise)?b[c].promise().then(l(c),i.reject,m(c)):--f;f||i.resolveWith(i,b)}else i!==a&&i.resolveWith(i,d?[a]:[]);return k},typeof module!="undefined"&&module.exports?module.exports=o:typeof a._!="undefined"?a._.mixin(o):a._=o})(this);if(typeof module!="undefined"&&module.exports){var a=module.exports;module.exports=function(b){b._=a}}}.call(this.lanyrd&&this.lanyrd.utils),function(a){function d(){var a=d.cached,b,c=null;if(a)return a();b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];do{a=b.shift();try{c=a(),d.cached=a;break}catch(e){}}while(b.length);return c}function e(a,b){var c=d(),e=lanyrd.utils.deferred();return c.open("GET",a,!0),c.onreadystatechange=function(){var a;if(c.readyState===4)try{c.status>=200&&c.status<300?(a=JSON.parse(c.responseText),e.resolve(a,c)):e.reject(c)}catch(b){e.reject(c,b)}},c.readyState!==4&&c.send(),e.promise(c).done(b)}function f(a,d){var e=lanyrd.utils.deferred(),f=document.createElement("script"),g="callback"+(c+=1),h=encodeURIComponent,i;return a=a.replace(/\?$/,g),window[g]=function(a){e.resolve(a),delete window[g]},f.src=a,f.onload=f.onreadystatechange=function(){if(!f.readyState||/loaded|complete/.test(f.readyState))f.onload=f.onreadystatechange=null,f.parentNode.removeChild(f),f=undefined},b.insertBefore(f,b.lastChild),setTimeout(e.reject,3e4),e.promise().done(d)}if(typeof module!="undefined"&&module.exports)return function(){var a=require("url"),b=require("http");module.exports=function(c){return c.json=c.jsonp=function(d,e){var f=a.parse(d),g=c.deferred(),h=g.promise();return h.xhr=b.get(f,function(a){var b=[];a.on("data",function(a){b.push(a)}),a.on("end",function(){try{a.statusCode>=200&&a.statusCode<300?g.resolve(JSON.parse(b.join()),a):g.reject(a)}catch(c){g.reject(a,c)}})}),h},c}}();var b=document.getElementsByTagName("head")[0],c=0;lanyrd.utils.json=e,lanyrd.utils.jsonp=f}(this.lanyrd&&this.lanyrd.utils);